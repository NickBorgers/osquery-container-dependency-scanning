WITH PID_QUERY AS (SELECT DISTINCT
    proc.path,
    proc.cmdline,
    proc.pid as pid,
    mmap.path AS mmap_path
FROM process_memory_map AS mmap
LEFT JOIN processes AS proc USING(pid))
SELECT pid, mmap_path
FROM PID_QUERY
JOIN yara ON yara.path = PID_QUERY.mmap_path
WHERE pid_with_namespace = PID_QUERY.pid
AND sigrule = 'rule openssl_3 {
        strings:
                $re1 = /OpenSSL\s3\.[0-6]{1}\.[0-9]{1}[a-z]{,1}/
        condition:
                $re1
}
'
AND yara.count > 0;